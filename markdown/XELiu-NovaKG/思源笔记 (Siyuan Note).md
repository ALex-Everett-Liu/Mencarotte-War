- #inbox
    - 对于[开发者](https://ld246.com/article/1619080345258)来说，[另一条路]是[一开始就不选择]以 [Markdown 文本]作为[存储格式]，而是使用[更结构化的存储方式]，比如[数据库]或者 JSON，然后[在应用层面][支持 Markdown 语法排版]。[选择这条路]的开发者，也许[已经预见到了][将来可能的复杂场景]。 #pt9-99.99
        - 在[扩展语法]的道路上[越走越远]以后，我们发现这似乎是在[开历史的倒车]。随着更多[特定语法]的引入，Markdown 的[通用性]逐步散失，就好像变成了[特定软件的私有格式]一般。更讽刺的是，[语法引入]却不能解决 Markdown 最大的问题 —— 自带资源文件（虽然 TextBundle/TextPack 做了一些努力，但[就目前而言]基本也还是[不通用]）。
        - 我觉得这是一个发展方向, 我个人也认为原始纯粹的 md 本身[并不适合做笔记].
            - 这并不像更简单 json 取代复杂的 xml 那样, 因为[用途不一样], 我觉得 用 usd 做类比, [展望笔记的未来]才更合适.
    - 经过一段时间的[调研和尝试](https://ld246.com/article/1619868273581)，[我们确认了]使用[标准 Markdown 语法]（CommonMark/GFM）是[无法实现][块级引用]的，必须[引入扩展语法]。在众多的 [Markdown 扩展语法]中，我们选择了 [kramdown](https://link.ld246.com/forward?goto=https%3A%2F%2Fkramdown.gettalong.org) 提供的[内联属性列表]（[Inline Attribute Lists](https://link.ld246.com/forward?goto=https%3A%2F%2Fkramdown.gettalong.org%2Fsyntax.html%23inline-attribute-lists)）语法给[块级元素][做标识]，让每个块级元素都[拥有唯一的 ID]。这样[在引用的时候]就能[精确地获取到]该块。保持 [Markdown 文本][人类易读写]的前提下[最大限度地实现]通用性和互操作性。 #pt8-99.99
        - All non-trivial [[abstraction]]s, to some degree, are leaky.
    - 我们工作里的图形，用到的[节点文本]，大量是从[数据库设计]和[程序流设计]里引用的[元术语]，如果用 visio 画，一旦设计改动，图形需要[大量手工更新]，现在思源的[嵌入特性]，不仅使得图形可以直接复制笔记中的术语，还可以用[编程工具]，在元术语基础上，生成画图脚本，贴到思源中渲染；[程序注释]的一部分工作都可以[迁移过来]，使得[设计和构建][无缝对接和更新]；
        - JSON 的[开放性]，给了[二次开发]极大的可能，我们有队员已经尝试将 .sy 文件的链接全部导入 neo4j，可以有更丰富的[笔记分析应用]可能；
        - JSON 也使得[我们团队]以 git flow 管理了[全局文档]，可以[即时看到][更新的细节]，也可以做好[全局定稿]和[局部草稿]的管理，比[在线同步的工具][更适合开发]。
        - 作者：[audiolabj](https://ld246.com/article/1626434677993) -- sbnmsl   #pt8-99.98
    - 思源笔记，目前的同步，已经有了，但是为了保险可见，还是用[坚果云][监控 data 目录](https://ld246.com/article/1628821895900)，相信[很多使用者][也是两个都用]，为了避免两部电脑[配置文件不同]（mac、window）[减少冲突]，都是[只同步源文件]，把思源的 .siyuan 这些目录[过滤掉]。 #pt7-99.98
    - 我的设备有四个：公司 PC、家用 PC、手机、docker server，家用 PC [是主力]。在[手机同步][卡了很久最后进去了]之后，我也就没用手机看笔记了。[回到家]打开家用 PC，发现有不少[之前已经编辑过的文档][被还原到了老状态]，尤其是[那些移动了位置的文档]，出现了双份，老位置和新位置各一份，并且 ID 还是相同的，这时候数据应该就已经出问题了，尝试[重建索引]没什么用，只能手动通过[数据历史回退]、[删除多余文档][来一个个解决]。

[我自然也没注意][其他看上去没事的文档](https://ld246.com/article/1658731734988)。

[结果今天来公司]打开思源，直接报错“[数据仓库][因为外部变更损坏] cloud object not found in v2.1.1”，可我这没有外部变更啊？一切都是思源自己的操作。没办法，只好按 D 大说的步骤，所有设备[暂停同步]（由于[暂时没法操作]家用 PC，还好白天不开它，就当它不存在吧），重置数据仓库，新建[云端目录]……   #pt7-99.98


        - 这之后[同步是没问题了]，但数据[变得更乱了]，又出现了不少[重复文档]，很多[编辑过的文档][被回退到了好几天前]。还好[社区里有朋友提醒][操作之前]先 [export data backup]，我能[手动从 data 备份中找到][那些跟当前不一致的内容]，但要[一一恢复]也很麻烦，一是思源 [UI 里只支持显示][最近 32 次历史操作]（这个设计[其实相当鸡肋]，因为是[以操作为单位]，而非[以文件为单位]，所以这 32 条历史记录很可能[对应的是同一个文件]，那其他文件[就只能手动去恢复了]）；二是针对[数据历史][只能回退而不能合并]，也就是说在历史版本之后[我做的所有的操作]，在回退时[都会被覆盖掉]。

对我来说，损失倒不大，我自己应该能最终[把所有的数据][调整到完整而合适的状态]，但[手动操作][实在是太麻烦了]。这次[同步机制]的更新带来的问题影响非常大，希望今后不会再出现这样的情况。
